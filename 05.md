# 05: æ„å‘³ãŒé¡žä¼¼ã—ãŸæ¤œç´¢èªžã®ã¨ã‚‰ãˆæ–¹

## åŒç¾©ï¼ˆé¡žç¾©ï¼‰é–¢ä¿‚ï¼Œä¸Šä½ãƒ»ä¸‹ä½é–¢ä¿‚

- åŒç¾©ï¼ˆé¡žä¼¼ï¼‰é–¢ä¿‚
  - ã»ã¨ã‚“ã©ã®ï¼ˆã™ã¹ã¦ã®ï¼‰æ–‡è„ˆã§ç½®ãæ›ãˆå¯èƒ½ãªå˜èªž
  - è»Š=è‡ªå‹•è»Š, CO2=äºŒé…¸åŒ–ç‚­ç´ 
- ä¸Šä½ä¸‹ä½é–¢ä¿‚
  - A âˆ‹ B ãªã‚‰ A ã¯ B ã®ä¸Šä½èªž
  - å“ºä¹³é¡ž âˆ‹ {ãƒã‚³, ã‚¤ãƒŒ, ãƒ’ãƒˆ}
- å…¨ä½“ãƒ»éƒ¨åˆ†é–¢ä¿‚
  - é¡”={ç›®, é¼», å£}

## WordNet

- ãƒ—ãƒªãƒ³ã‚¹ãƒˆãƒ³å¤§å­¦ã§é–‹ç™º
- æ„å‘³é–¢ä¿‚ã«ç„¦ç‚¹ã‚’å½“ã¦ãŸè¾žæ›¸
- 155,287 èªžï¼Œ117,659 ã®åŒç¾©èªžé›†åˆ

## æ—¥æœ¬èªžãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒˆ

- æƒ…å ±é€šä¿¡ç ”ç©¶æ©Ÿæ§‹ãŒé–‹ç™º
- 9 ä¸‡èªž

## å˜èªžã®åˆ†å¸ƒä»®èª¬

- Zellig Harris ã•ã‚“ (1954)

  - ã€Œ`oculist` ã¨`eye-doctor` ã¯ï¼Œã»ã¼åŒã˜å‘¨å›²èªžã®ä¸­ã«å‡ºç¾ã€
  - ã€Œå˜èªž A ã¨ B ãŒã»ã¼åŒã˜å‘¨å›²èªžã®ä¸­ã«å‡ºç¾ã™ã‚‹ã®ã§ã‚ã‚Œã°ï¼ŒåŒç¾©èªžã¨è¦‹ãªã™ã€

- Firth ã•ã‚“ (1957)
  - "You shall know a word by the company it keeps!"
  - ã€Œå˜èªžã®æ„å‘³ã¯ãã®å‘¨å›²ã®è¨€è‘‰ã«ã‚ˆã‚Šç†è§£ã§ãã‚‹ã‚ˆ ðŸŽ¶ã€

## å‘¨å›²èªžã®åˆ†å¸ƒã«ã‚ˆã‚‹å˜èªžã®æ„å‘³ã®æŽ¨å®š

- å˜èªžã®æ„å‘³ã¯å‘¨ã‚Šã®å˜èªžã‚’è¦‹ã‚Œã°(ã ã„ãŸã„)æŽ¨æ¸¬ã§ãã‚‹
  - æ˜¨æ—¥ã‚‚ãƒãƒ‹ãƒ§ã‚’é£Ÿã¹ãŸï¼Ž(ãƒãƒ‹ãƒ§=é£Ÿå“ï¼Ÿ)
  - æœè¦‹ãŸã‚‰ãƒãƒ‹ãƒ§ãŒç†Ÿã—ã¦ã„ãŸï¼Ž(ãƒãƒ‹ãƒ§=æžœå®Ÿï¼Ÿ)
  - ãƒãƒ‹ãƒ§ã«ã¯ãƒ¬ãƒ¢ãƒ³ã‚’ã¡ã‚‡ã£ã¨ã‹ã‘ã‚‹ã¨ã†ã¾ã„ï¼Ž(ãƒãƒ‹ãƒ§=ãƒ¬ãƒ¢ãƒ³ãŒåˆã†æ–™ç†ï¼Ÿ)

## å˜èªžé–“é¡žä¼¼åº¦ã¨å˜èªž

### æ–‡è„ˆè¡Œåˆ—

- å‘¨å›²ã®å˜èªž(=æ–‡è„ˆ)ã®åˆ†å¸ƒãŒä¼¼ã¦ã„ã‚‹ 2 å˜èªžã¯æ„å‘³ã‚‚ä¼¼é€šã£ã¦ã„ã‚‹ã¯ãšï¼
  - å…¨å˜èªžã«ã¤ã„ã¦è¦‹ã‚‹ã®ã¯ãã¤ã„

### å˜èªžé–“å…±èµ·è¡Œåˆ— (word co-occurrence matrix)

- è¦‹ã‚‹ã€Œå‘¨å›²ã€ã‚’å¤§ãã•(=çª“å¹…, window size)ã¨æ®µè½å˜ä½ã«çµžã£ãŸæ–‡è„ˆè¡Œåˆ—
  - çª“å¹…ãŒçŸ­ã‘ã‚Œã°æ§‹æ–‡, é•·ã‘ã‚Œã°æ„å‘³ã‚’é‡è¦–
- ã‚µã‚¤ã‚ºã¯èªžå½™æ•°|V|Ã—|V|ã®ç–Žè¡Œåˆ—ã¨ãªã‚‹
  - ã™ã£ã‹ã™ã‹ãªã®ã§ãã“ã¯ç„¡è¦–ã—ã¦å‡¦ç†ã§ãã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒãŸãã•ã‚“ã‚ã‚‹

### å‡ºç¾é »åº¦ã«ã‚ˆã‚‹å•é¡Œ

- å˜èªžé–“ã®é–¢ä¿‚ã‚’æŽ¨å®šã™ã‚‹ä¸Šã§å‡ºç¾é »åº¦ã¯ååˆ†ã«æ´—ç·´ã•ã‚ŒãŸæ–¹æ³•ã§ã¯ãªã„
  - é »åº¦åˆ†å¸ƒã®åã‚Šã‚’è€ƒæ…®ã—ãªã‘ã‚Œã°ãªã‚‰ã¬
  - é«˜é »å‡ºã®`of`, `the`ãªã©ã¯æ„å‘³ãŒã‚ã‚“ã¾ãªã„ã®ã§ç„¡è¦–ã—ãŸã„
- æ­£ã®ç›¸äº’æƒ…å ±é‡(P-PMI)
  - æ–‡è„ˆèªžãŒå¯¾è±¡ã¨ãªã‚‹å˜èªžã«å¯¾ã—ã¦ã‚ˆã‚Šæƒ…å ±é‡ã‚’æä¾›ã™ã‚‹ã‹æ¸¬ã‚‹å°ºåº¦
  - `2å˜èªžé–“PMI(w1, w2) = logâ‚‚{P(w1,w2)/P(w1)ï½¥P(w2)}`
  - P-PMI = (PMI.negative? ? 0 : PMI)

### æ¬¡å…ƒå‰Šæ¸›

- ãƒ™ã‚¯ãƒˆãƒ«ã®æ¬¡å…ƒæ•°ã‚’å‰Šæ¸›ã—ãŸã„
  - ãƒ‡ãƒ¼ã‚¿ã®åºƒãŒã‚Šã‚’åæ˜ ã—ãŸæ¬¡å…ƒã¸å†™åƒ
  - ãƒ‡ãƒ¼ã‚¿ã®æœ¬è³ªçš„ãªå·®ç•°ã‚’åæ˜ ã—ãŸé‡è¦ãªæƒ…å ±ã‚’æ®‹ã™ã“ã¨ã§åœ§ç¸®
  - ã»ã¨ã‚“ã©ã®è¦ç´ ãŒ 0 ã§ã‚ã‚‹è¡Œåˆ—ï¼ˆç–Žï¼‰ã‚’å¯†ãªãƒ™ã‚¯ãƒˆãƒ«ã¸å¤‰æ›
  - ç‰¹ç•°å€¤åˆ†è§£ï¼ˆSingle Value Decomposition, SVDï¼‰ã«ã‚ˆã‚‹æ¬¡å…ƒå‰Šæ¸›
    - ç›´äº¤è¡Œåˆ— U ã«åˆ†è§£ã—ã¦ï¼Œé‡è¦åº¦ã®é«˜ã„æ¬¡å…ƒã‚’æ®‹ã™

## æ„å‘³è§£æžã®å•é¡Œç‚¹

- WordNet ã®åˆ©ç”¨ã®å•é¡Œç‚¹
  - ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã®æ¬ è½
    - ä¾‹ï¼š`good` ã®åŒç¾©èªžã¨ã—ã¦`proficient` ãŒç™»éŒ²
  - ã‚ã‚‹æ–‡è„ˆã«ãŠã„ã¦ã®ã¿åŒç¾© ïƒ¼ æ–°èªžã®æ›´æ–°ã‚’ã—ç¶šã‘ã‚‹ã“ã¨ãŒå›°é›£
  - ã‚·ã‚½ãƒ¼ãƒ©ã‚¹ä½œæˆè€…ã®ä¸»è¦³ãŒé¿ã‘ã‚‰ã‚Œãªã„
  - ã‚·ã‚½ãƒ¼ãƒ©ã‚¹ã®æ§‹ç¯‰ã‚„ä¿å®ˆã«äººæ‰‹ãŒå¿…è¦
- SVD ã®åˆ©ç”¨ã®å•é¡Œç‚¹
  - nÃ—m ã®è¡Œåˆ—ã«å¯¾ã—ã¦äºŒä¹—ã®ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ï¼šO(mï½¥n^2)
    - ä½•ç™¾ä¸‡èªžã‚„ä½•ç™¾ä¸‡æ–‡æ›¸ã‚’å¯¾è±¡ã¨ã™ã‚‹ã“ã¨ãŒé›£ã—ã„
  - æ–°èªžã‚„æ–°ã—ã„æ–‡æ›¸ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒé›£ã—ã„

## å˜èªžã®ãƒ™ã‚¯ãƒˆãƒ«è¡¨ç¾

- ãƒ¯ãƒ³ãƒ›ãƒƒãƒˆãƒ™ã‚¯ãƒˆãƒ«

  - å„å˜èªžã‚’é›¢æ•£çš„ã«è¡¨ç¾, ç–Žãƒ™ã‚¯ãƒˆãƒ«
  - ãƒ™ã‚¯ãƒˆãƒ«ã®æ¬¡å…ƒæ•°=èªžå½™æ•°(å·¨å¤§ã«ãªã‚‹)
  - ãƒ¯ãƒ³ãƒ›ãƒƒãƒˆãƒ™ã‚¯ãƒˆãƒ«ã§ã¯é¡žä¼¼åº¦ã¯æ¸¬ã‚Œãªã„

- å˜èªžãƒ™ã‚¯ãƒˆãƒ«è‡ªèº«ã«ã¤ã„ã¦ï¼Œå˜èªžé–“ã®é¡žä¼¼æ€§ã‚’ã‚³ãƒ¼ãƒ‰åŒ–ã™ã‚‹ã‚ˆã†ã«å­¦ç¿’ã—ãŸã„
  - å˜èªžã®åŸ‹ã‚è¾¼ã¿ã‚’ç”¨ã„ã‚‹

## å˜èªžã®åŸ‹ã‚è¾¼ã¿ï¼ˆWord Embeddingï¼‰

- é¡žä¼¼ã—ãŸæ–‡è„ˆã«å‡ºç¾ã™ã‚‹å˜èªžãƒ™ã‚¯ãƒˆãƒ«ãŒé¡žä¼¼ã™ã‚‹ã‚ˆã†ã«å˜èªžã®å¯†ãªãƒ™ã‚¯ãƒˆãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨

  - åœ§å€’çš„ã«åœ§ç¸®ã§ãã‚‹

- Firth ã•ã‚“ (1957)

  - ã€Œå˜èªžã®æ„å‘³ã¯ãã®å‘¨å›²ã®å˜èªžã«ã‚ˆã‚Šç†è§£ã§ãã‚‹ã€

- ã‚ã‚‹å˜èªž w ã®è¤‡æ•°ã®æ–‡è„ˆï¼ˆcontextï¼‰ã‚’ä½¿ç”¨ã—ã¦ï¼Œå˜èªž w ã®è¡¨ç¾ã‚’æ§‹ç¯‰
  - æ–‡è„ˆï¼šã‚ã‚‹å˜èªžã®å‘¨å›²ï¼ˆå›ºå®šé•·ã®çª“å¹…= å˜èªžæ•°ï¼‰ã«å‡ºç¾ã™ã‚‹å˜èªžã®é›†åˆ

## Word2Vec

- å˜èªžãƒ™ã‚¯ãƒˆãƒ«ã‚’å­¦ç¿’ã™ã‚‹æž çµ„ã¿
  - å¯¾è±¡ã¨ãªã‚‹å˜èªž`wt`ãŒä¸Žãˆã‚‰ã‚ŒãŸéš›ã«æ–‡è„ˆã¨ãªã‚‹å˜èªž`wt+j`ãŒå‡ºç¾ã™ã‚‹ç¢ºçŽ‡ P ã‚’æœ€å¤§åŒ–ã™ã‚‹ã‚ˆã†ã«ï¼Œå˜èªžãƒ™ã‚¯ãƒˆãƒ«ã‚’èª¿æ•´

### åˆ©ç”¨

```python
# 4.x.y cannot work with models for Kyubyong/wordvectors
import json
from typing import List, Tuple, TypedDict

from gensim.models import Word2Vec  # gensim==3.8.3

# https://drive.google.com/open?id=0B0ZXk88koS2KVVNDS0lqdGNOSGM


class SimDict(TypedDict):
    term: str
    similarity: float


Sims = List[SimDict]


def get_synonyms(model: Word2Vec, input_word: str) -> Sims:
    """é¡žä¼¼èªžã®å–å¾—"""
    results = [{'term': word, 'similarity': sim}
               for word, sim in model.most_similar(input_word, topn=10)]
    return results


def calc_similarity(model: Word2Vec, t1: str, t2: str) -> float:
    """é¡žä¼¼åº¦è¨ˆç®—"""
    return model.similarity(t1, t2)


def analogy(model: Word2Vec,
            relpair_x_y: Tuple[str, str], input_x: str) -> Sims:
    """ã‚¢ãƒŠãƒ­ã‚¸ãƒ¼è¨ˆç®—"""
    x, y = relpair_x_y
    results = [{"term": word, "similarity": sim}
               for word, sim in model.most_similar(positive=[y, input_x],
                                                   negative=[x], topn=10)]
    return results


def main() -> None:
    def p(d): return print(json.dumps(d, indent=4, ensure_ascii=False))

    model = Word2Vec.load('./data/ja.bin')

    syms = get_synonyms(model, 'ã‚¢ãƒ¡ãƒªã‚«')
    res = analogy(model, ('ãƒ•ãƒ©ãƒ³ã‚¹', 'ãƒ‘ãƒª'), 'æ—¥æœ¬')
    p(syms)
    p(res)


if __name__ == '__main__':
    main()
```
